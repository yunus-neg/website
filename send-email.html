<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Language" content="ar" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" type="text/css" href="hanadi.css" />
  <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAS5SURBVGhD7VhbT1xVFEYfjA8an0xM1MQ/4Ksm+sBD58acw8DA3jNcLMzItOWSthJMiwIFWrAYi1qTqrUxwXgjFkNbW6SWak1Te1GkUIECLdOBKaXlDgWsNS7XnrPPmTNwhtBxmCHmfMkXCPuctb5vr7332pwEHTp06NChQ4eO/zESKX3MIBCbUSTlRpF+YBRII/7+iUkku02iI9ViIU/yR9cnjMmOl1HwcRT/p0mksALvo6kTRjHdxF9dHzClOJ9lwtRizckO8BQUw443q6Gsci+U7NwF7s1bA39XP2cSyGlzivM5Hip+YLOKVbgjC9tcVAItrafh9u0JWFy8r3Byag6Ghkeg9+oAfPFVE7y6ZbtiBt+fYUuRh4w9AvtAIH8zMXaHC062/QwLC3+FGFBzfv4ejI6Ogc/nhxs3huHLxiawkY2yIbbcnDx07GC0pr9oFOg8E5GX/xp4vTc1xWtxfHw6YIbx4qUOyHbnS5URyD2TNf0lnmLtkZiY+yguh2ss+SvuAvD7RzUFr8QpXGqymY6OLnBu3MQrQ/w2m+1xnmptgTNXw5ImpWRAT+91TaGrodrMqbYzykFgtJKDZoFWYZ4jJoGeMVnJYZZTEHKe5hL+O9hs4azdZQkPHGzQFPggHBubUsyUVtTwqoQnGhqxCE7K5UQOg0g8LKA1NXPZyRQpR0buwMeHPgOLzRki2mxzgGDPBMvSI5uNifQCpfQRLuvBgTPyAwtUVbNPU1QkrN//kSLQ7siFPW/VQ3dPf2BsYmImUK1z53+Dsl21S0yRWxGbkXtG87HWZYIiZba7MCCsvGovCp9dNj41fVdZft29/ZCZu0UxY0yml7m01UPq4FKAy509yxJGyqt9Xmj78eyKPUi9l7zeIchyFShmNoikkEsMj8rKyoexhG6sxEV8CZuW9HKqIwdq394Pff1ezcTRJjM57L+lmOnruw5JtgxuhsxwudqwWulTeBc6L4vXojU1AxoPH9VMHm2qGyljTd27QR3hGqnBQJ/Ajd0tP/h6aRV8f/InuPJHH/za3gUNn38DjmyPEuiXC+2ayaPJubnFECOdXT3s9JI0WOnXXHoosBEdYg+wJtXU3KIZmM0Qu9nSLA/0D/g0n4k21UYYBXtWwAhO+iUuPQiLxf4MDgQug9FoetEku0GrjaRluKSKCOQalx8EbuxCNiimZQVOC62A8aLaBGO2SzqKceIbufwg0MiHbHBbSZlmsHhx6R4ZGBgEUV5aIi3m8oPA46yBDZaW79EMGC/KXV7mt83HpWWF3JBEnufyg8CK1LHBnLwizYDxIvt3QTbBmqJr01ZuhPRw6aHAa7NFdtr++xXNoLHm5ORsSDX2vXdAqQbuD8Klh4JdxHDQyx7Ky98O4xPTmsFjxdnZBRgauqlUov794CUTT6tjKPkhSbkG0IgdH/xHNhOvykxPz4MPTQwO+uDod63gyS9WVYJ2ssbNJYcHmnlDNsOY4ykKNMDq2vo1Z1XNO1BRXQc7y3ZDwbYd6o8UEgXasioTMtAMxfL5QoLEkwIZNCTTTHaZ5RJXD/axwWxNT5M+f9IjeKqdihXxRDqBPz/FvBVo4gWUE34/6NChQ4cOHTp0rFckJPwL4qQcu4ZL4ykAAAAASUVORK5CYII=" />
  <title>أنظمة غيمة - Cloud Systems - تواصل معنا</title>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-56731261-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-56731261-3');
  </script>
</head>
<body>
  <nav id="error-message" class="error">
    Something went wrong!
  </nav>
  <nav>
    <ul>
      <li>
        <a href="index.html">الرئيسيّة</a>
      </li>
    </ul>
  </nav>
  <div class="container">
    <div class="logo">
      <a href="index.html">
        <img src="http://techlify.com/sites/default/files/2017-07/cloud-computing.png" width="55px">
      </a>
    </div>
    <div class="breif">
      <strong>إرسال رسالة:</strong> يُمكنك إرسال رسالة جماعيّة لأيّ أو لكلّ فئةٍ تريد.
    </div>
    <div class="form-container">
      <form id="form">
        <div class="form-input">
          <label>المُستقبِلون (مطلوب)</label>
          <!-- All -->
          <input type="radio" name="to" id="toAll" value="all" checked required />
          <label class="radio-label" for="toAll">الكلّ</label>
          <!-- Contributors -->
          <input type="radio" name="to" id="toContributors" value="contributors" required />
          <label class="radio-label" for="toContributors">المُساهِمون</label>
          <!-- Trainees -->
          <input type="radio" name="to" id="toTrainees" value="trainees" required />
          <label class="radio-label" for="toTrainees">المتدرّبون</label>
        </div>
        <div class="form-input">
          <label for="subject">الموضوع (مطلوب)</label>
          <input type="text" id="subject" placeholder="مرحبًا بكم" required />
        </div>
        <div class="form-input">
          <label for="message">الرسالة (مطلوب)</label>
          <textarea id="message" placeholder="نصّ الرسالة مفصّلاً" required></textarea>
        </div>
        <div class="form-buttons">
          <input type="submit" id="submit" class="submit" value="أرسِل إليهم" />
        </div>
      </form>
    </div>
    <div class="copyrights">
      (ح) جميع الحقوق محفوظة لمؤسّسة أنظمة غيمة (Cloud Systems).
    </div>
  </div>
  <script type="text/javascript">

    // Define some variables.
    var errorMessage = document.getElementById('error-message');
    var form = document.getElementById('form');
    var subject = document.getElementById('subject');
    var message = document.getElementById('message');
    var submit = document.getElementById('submit');
    var accessToken = Cookies.get('accessToken');

    // Hide the error message initially.
    errorMessage.style.display = 'none';

    if (!accessToken) {
      // submit.disabled = true;
      errorMessage.style.display = 'block';
      errorMessage.innerHTML = 'يجب <a href="trainees.html">تسجيل الدخول</a> كي تتمكّن من إرسال الرسالة.';
    }

    // Define variables to be used to send a request.
    var http = new XMLHttpRequest();
    var url = 'https://d2hbxkrooc.execute-api.eu-west-1.amazonaws.com/dev/emails';

    http.onreadystatechange = function() {
      if (http.readyState == XMLHttpRequest.DONE) {
        submit.disabled = false;
        if (http.status == 204) {
          return window.location.href = 'thank-you-for-contacting-us.html';
        }
        errorMessage.style.display = 'block';
        if (http.status == 400) {
          errorMessage.innerHTML = 'الرجاء التأكّد من تعبئة الحقول المطلوبة.';
        }
        if (http.status == 408) {
          errorMessage.innerHTML = 'لا يُمكن إرسال البريد الآن، نرجو المحاولة لاحقًا.';
        }
        if (http.status == 401) {
          errorMessage.innerHTML = 'لا يُمكن الوصول إلى هذه الصفحة.';
        }
      }
    }

    var handleSubmit = function(event) {
      event.preventDefault();

      var to = document.querySelector('input[name="to"]:checked').value;
      var htmlMessage = createTextLinks_(message.value);
      htmlMessage = htmlMessage.replace(new RegExp('\r?\n','g'), '<br />');

      if (to == 'all') {
        to = ['contributors', 'trainees'];
      }
      else {
        to = [to];
      }

      submit.disabled = true;
      errorMessage.style.display = 'none';

      http.open('POST', url, true);

      // Set some headers.
      http.setRequestHeader('Content-type', 'application/json');
      http.setRequestHeader('Accept', 'application/json');
      http.setRequestHeader('Authorization', 'Bearer ' + accessToken);

      // Make a new request.
      var params = JSON.stringify({
        'to': to,
        'subject': subject.value,
        'message': '<div style="direction: rtl">' + htmlMessage + '</div>',
      });

      http.send(params);
    }

    // Start dealing with them.
    form.addEventListener('submit', handleSubmit, false);

    // https://ctrlq.org/code/20294-regex-extract-links-javascript
    function createTextLinks_(text) {
      return (text || "").replace(
        /([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi,
        function(match, space, url){
          var hyperlink = url;
          if (!hyperlink.match('^https?:\/\/')) {
            hyperlink = 'http://' + hyperlink;
          }
          return space + '<a href="' + hyperlink + '">' + url + '</a>';
        }
      );
    };

  </script>
</body>
</html>